
from shapely.geometry.polygon import Polygon
from shapely.geometry import Point

# List of The nafots
nafot = ['HaSharon', 'PetahTikva', 'TelAviv', 'Ramle', 'Rehovot', 'Ashkelon', 'BeerSheva', 'Jerusalem']

# Dictionary which contains the border points for each nafa
nafotBorders = {}

# Defining the nafots' border points
# HaSharon borders
nafotBorders[nafot[0]] = [(186925, 702352), (192098, 702150), (198246, 701345), (200500, 698703),(204925, 698048),
                          (204067, 694736), (201624, 693801), (201094, 687455), (203009, 685867), (202340, 683907),
                          (189176, 681641),(189852, 675768),(181435, 679411)]

# PetahTikva borders
nafotBorders[nafot[1]] = [(202340, 683907), (189176, 681641), (189852, 675768), (185408, 663721), (187606, 664184),
                          (188362, 658841), (186416, 658562), (185648, 657632), (191798, 653332), (189749, 648244),
                          (195234, 646337), (196882, 649037), (203761, 645659), (199469, 653347), (200585, 658905),
                          (199544, 668221), (199199, 672518), (197016, 678070)]

# TelAviv borders
nafotBorders[nafot[2]] = [(181435, 679411), (189852, 675768), (185408, 663721), (187606, 664184), (188362, 658841),
                          (186416, 658562), (183861, 659418), (181537, 655322), (173272, 657630)]

# Ramle borders
nafotBorders[nafot[3]] = [(183861, 659418), (186416, 658562), (185648, 657632), (191798, 653332), (189749, 648244),
                          (195234, 646337), (196882, 649037), (203761, 645659), (203141, 640424), (199726, 640112),
                          (194211, 639706), (191563, 637643), (192173, 635926), (187998, 635329), (187336, 637448),
                          (185825, 637317), (186350, 640221), (184952, 640691), (184623, 638510), (183237, 639244),
                          (184162, 641491), (182908, 642088), (185945, 645992), (182566, 647570), (185150, 653258),
                          (182634, 657556)]

# Rehovot borders
nafotBorders[nafot[4]] = [(173272, 657630), (181537, 655322), (182634, 657556), (185150, 653258), (182566, 647570),
                         (185945, 645992), (182908, 642088), (184162, 641491), (183237, 639244), (184623, 638510),
                          (184952, 640691), (186350, 640221), (185825, 637317), (187336, 637448), (187998, 635329),
                         (183101, 632815), (179660, 629838), (177813, 634669), (175242, 635988), (172728, 634868),
                         (174435, 633091), (172395, 630835), (168752, 632222), (170661, 634340), (169681, 635392),
                         (168876, 634338), (169009, 637391), (172713, 639566), (167551, 641421)]

# Ashkelon borders
nafotBorders[nafot[5]] = [(187621, 618348), (188088, 628529), (184927, 629263), (183101, 632815), (179660, 629838),
                          (177813, 634669), (175242, 635988), (172728, 634868), (174435, 633091), (172395, 630835),
                          (168752, 632222), (170661, 634340), (169681, 635392), (168876, 634338), (169009, 637391),
                          (172713, 639566), (167551, 641421), (150975, 612390), (158917, 605715), (149536, 597193),
                          (154489, 595989), (157079, 599366), (162101, 596328), (164017, 597456), (163940, 600553),
                          (166788, 599157), (169439, 601210), (169233, 596988), (174660, 595852), (174592, 598907),
                          (177648, 599159), (188094, 591292), (187621, 594269), (190530, 594068), (194846, 602006),
                          (196228, 612455)]


# BeerSheva borders
nafotBorders[nafot[6]] = [(149536, 597193), (154489, 595989), (157079, 599366), (162101, 596328), (164017, 597456),
                          (163940, 600553), (166788, 599157), (169439, 601210), (169233, 596988), (174660, 595852),
                          (174592, 598907), (177648, 599159), (188094, 591292), (187621, 594269), (190530, 594068),
                          (193084, 583422), (222055, 587789), (237924, 599969), (240306, 580386), (239779, 539763),
                          (227345, 515026), (149166, 515553), (130111, 570199), (139638, 577864), (139508, 586065)]


# Jerusalem borders
nafotBorders[nafot[7]] = [(196228, 612455), (187621, 618348), (188088, 628529), (184927, 629263), (183101, 632815),
                         (187998, 635329), (187998, 635329), (192173, 635926), (191563, 637643), (194211, 639706),
                         (199726, 640112), (197873, 637855), (202439, 637594), (205025, 640508), (208256, 639970),
                         (217716, 635212), (217522, 636927), (220172, 636074), (220315, 643416), (221687, 640971),
                         (225137, 637130), (222753, 624102), (213155, 626290)]


# Creating Polygon objects
polygons = {}

for nafa in nafot:
    poly = Polygon(nafotBorders[nafa])
    polygons[nafa] = poly

print(polygons[nafot[0]].exterior.xy)

#######################################################################################################################
# Functions

# Recives coordinates x,y and returns the relevant nafa
def nafa(x,y):

    # The returned value
    nafa = None

    # Create Point object
    point = Point(x,y)

    # Check which nafa the point belongs to
    for currNafa in nafot:
        if polygons[nafa].contains(point):
            nafa = currNafa
            break
    return nafa


# Receives a list of points (as tupples/lists) and returns True
def in_same_nafa(xyList):

    # Create a list of Point objects
    pointsList = []
    for x,y in xyList:
        point = Point(x,y)
        pointsList.append(point)

    # Check if all points are in same nafa
    nafa = __name__.nafa(pointsList[0])
    for point in pointsList:
        currNafa = __name__.nafa(point)
        if currNafa != nafa:
            return False
    # If the loop ended and didn't return False
    return True
